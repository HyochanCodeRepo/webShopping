<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/default}"
      lang="ko">
<head>
    <title>홈 - 모던 쇼핑몰</title>
    <th:block layout:fragment="css">
        <link rel="stylesheet" th:href="@{/css/main.css}">
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Pretendard:wght@400;500;600;700&display=swap" rel="stylesheet">
    </th:block>
</head>
<body>
    <main layout:fragment="content">
        <!-- 메인 배너 슬라이더 - 무신사 스타일 -->
        <section class="hero-banner">
            <div class="banner-slider">
                <div class="banner-slide active" style="background-image: url('/images/main01.jpg');">
                    <div class="banner-content">
                        <h2>NEW SEASON</h2>
                        <p>2025 봄 신상품 컬렉션</p>
                    </div>
                </div>
                <div class="banner-slide" style="background-image: url('/images/main02.jpg');">
                    <div class="banner-content">
                        <h2>BEST SELLER</h2>
                        <p>인기 상품 모음</p>
                    </div>
                </div>
                <div class="banner-slide" style="background-image: url('/images/main03.jpg');">
                    <div class="banner-content">
                        <h2>SPECIAL OFFER</h2>
                        <p>최대 50% 할인</p>
                    </div>
                </div>
            </div>
            <div class="banner-controls">
                <button class="banner-prev" aria-label="이전 배너">
                    <i class="fas fa-chevron-left"></i>
                </button>
                <button class="banner-next" aria-label="다음 배너">
                    <i class="fas fa-chevron-right"></i>
                </button>
            </div>
        </section>
        
        <!-- 카테고리 그리드 - 무신사 스타일 -->
        <section class="category-cards">
            <div class="cards-container">
                <a th:href="@{/product/list(categoryId=${category.id})}"
                   class="category-card"
                   th:each="category : ${categories}">
                    <h3 th:text="${category.name}">카테고리명</h3>
                    <div class="card-image">
                        <img th:src="@{${category.imageUrl != null ? category.imageUrl : '/images/category-default.jpg'}}"
                             th:alt="${category.name}">
                    </div>
                    <span class="card-link">SHOP NOW →</span>
                </a>
            </div>
        </section>

        <!-- 오늘의 특가 섹션 -->
        <section class="deals-section">
            <div class="section-container">
                <h2 class="section-title">
                    <i class="fas fa-bolt"></i>
                    <span>오늘의 특가</span>
                </h2>
                
                <div class="products-slider" th:if="${!todayDeals.isEmpty()}">
                    <div class="product-card" th:each="product : ${todayDeals}">
                        <a th:href="@{/product/detail/{id}(id=${product.id})}" class="product-link">
                            <div class="product-image">
                                <img th:src="${product.repImageUrl != null ? product.repImageUrl : '/images/product-sample.jpg'}" 
                                     th:alt="${product.productName}">
                                <span class="deal-badge" th:text="${product.discountRate + '%'}">30%</span>
                            </div>
                            <div class="product-info">
                                <h4 class="product-name" th:text="${product.productName}">상품명</h4>
                                
                                <!-- 별점 -->
                                <div class="product-rating" th:if="${productReviewCounts[product.id] > 0}">
                                    <span th:each="i : ${#numbers.sequence(1, 5)}">
                                        <i th:class="${i <= productRatings[product.id] ? 'fas fa-star' : 
                                                      (i - 0.5 <= productRatings[product.id] ? 'fas fa-star-half-alt' : 'far fa-star')}"></i>
                                    </span>
                                    <strong th:text="${productRatings[product.id]}">4.5</strong>
                                    <span th:text="'(' + ${productReviewCounts[product.id]} + ')'">(25)</span>
                                </div>
                                
                                <div class="product-price">
                                    <span class="price-original" 
                                          th:text="${#numbers.formatInteger(product.price, 0, 'COMMA') + '원'}">35,000원</span>
                                    <span class="price-sale" 
                                          th:text="${#numbers.formatInteger(product.discountPrice, 0, 'COMMA') + '원'}">24,500원</span>
                                </div>
                                
                                <div class="prime-badge" th:if="${product.price >= 30000}">
                                    <i class="fas fa-truck"></i> 무료배송
                                </div>
                            </div>
                        </a>
                    </div>
                </div>
                
                <div th:if="${todayDeals.isEmpty()}" style="text-align: center; padding: 120px 20px; color: #999;">
                    <i class="fas fa-tags"></i>
                    <p>현재 진행 중인 특가 상품이 없습니다</p>
                </div>
            </div>
        </section>
        
        <!-- 베스트 상품 섹션 -->
        <section class="popular-section">
            <div class="section-container">
                <h2 class="section-title">
                    <i class="fas fa-trophy"></i>
                    <span>베스트 상품</span>
                </h2>
                
                <div class="carousel-wrapper">
                    <button class="carousel-btn prev" onclick="moveCarousel('popular', -1)" aria-label="이전">
                        <i class="fas fa-chevron-left"></i>
                    </button>
                    
                    <div class="products-carousel" id="popular-carousel" th:if="${!popularProducts.isEmpty()}">
                        <div class="product-card" th:each="product : ${popularProducts}">
                            <a th:href="@{/product/detail/{id}(id=${product.id})}" class="product-link">
                                <div class="product-image">
                                    <img th:src="${product.repImageUrl != null ? product.repImageUrl : '/images/product-sample.jpg'}" 
                                         th:alt="${product.productName}">
                                </div>
                                <div class="product-info">
                                    <h4 class="product-name" th:text="${product.productName}">상품명</h4>
                                    
                                    <!-- 별점 -->
                                    <div class="product-rating" th:if="${productReviewCounts[product.id] > 0}">
                                        <span th:each="i : ${#numbers.sequence(1, 5)}">
                                            <i th:class="${i <= productRatings[product.id] ? 'fas fa-star' : 
                                                          (i - 0.5 <= productRatings[product.id] ? 'fas fa-star-half-alt' : 'far fa-star')}"></i>
                                        </span>
                                        <strong th:text="${productRatings[product.id]}">4.5</strong>
                                        <span th:text="'(' + ${productReviewCounts[product.id]} + ')'">(25)</span>
                                    </div>
                                    
                                    <div class="product-price">
                                        <div th:if="${product.discountRate != null and product.discountRate > 0}">
                                            <span class="price-original" 
                                                  th:text="${#numbers.formatInteger(product.price, 0, 'COMMA') + '원'}">50,000원</span>
                                            <span class="price-sale" 
                                                  th:text="${#numbers.formatInteger(product.discountPrice, 0, 'COMMA') + '원'}">45,000원</span>
                                        </div>
                                        <div th:unless="${product.discountRate != null and product.discountRate > 0}">
                                            <span class="price-sale" 
                                                  th:text="${#numbers.formatInteger(product.price, 0, 'COMMA') + '원'}">50,000원</span>
                                        </div>
                                    </div>
                                    
                                    <div class="prime-badge" th:if="${product.price >= 30000}">
                                        <i class="fas fa-truck"></i> 무료배송
                                    </div>
                                </div>
                            </a>
                        </div>
                    </div>
                    
                    <button class="carousel-btn next" onclick="moveCarousel('popular', 1)" aria-label="다음">
                        <i class="fas fa-chevron-right"></i>
                    </button>
                </div>
                
                <div th:if="${popularProducts.isEmpty()}" style="text-align: center; padding: 120px 20px; color: #999;">
                    <i class="fas fa-box-open"></i>
                    <p>등록된 상품이 없습니다</p>
                </div>
            </div>
        </section>
        
        <!-- 신상품 섹션 -->
        <section class="new-section">
            <div class="section-container">
                <h2 class="section-title">
                    <i class="fas fa-sparkles"></i>
                    <span>신상품</span>
                </h2>
                
                <div class="carousel-wrapper">
                    <button class="carousel-btn prev" onclick="moveCarousel('new', -1)" aria-label="이전">
                        <i class="fas fa-chevron-left"></i>
                    </button>
                    
                    <div class="products-carousel" id="new-carousel" th:if="${!newProducts.isEmpty()}">
                        <div class="product-card" th:each="product : ${newProducts}">
                            <a th:href="@{/product/detail/{id}(id=${product.id})}" class="product-link">
                                <div class="product-image">
                                    <img th:src="${product.repImageUrl != null ? product.repImageUrl : '/images/product-sample.jpg'}" 
                                         th:alt="${product.productName}">
                                    <span class="new-badge">NEW</span>
                                </div>
                                <div class="product-info">
                                    <h4 class="product-name" th:text="${product.productName}">상품명</h4>
                                    
                                    <!-- 별점 -->
                                    <div class="product-rating" th:if="${productReviewCounts[product.id] > 0}">
                                        <span th:each="i : ${#numbers.sequence(1, 5)}">
                                            <i th:class="${i <= productRatings[product.id] ? 'fas fa-star' : 
                                                          (i - 0.5 <= productRatings[product.id] ? 'fas fa-star-half-alt' : 'far fa-star')}"></i>
                                        </span>
                                        <strong th:text="${productRatings[product.id]}">4.5</strong>
                                        <span th:text="'(' + ${productReviewCounts[product.id]} + ')'">(25)</span>
                                    </div>
                                    
                                    <div class="product-price">
                                        <div th:if="${product.discountRate != null and product.discountRate > 0}">
                                            <span class="price-original" 
                                                  th:text="${#numbers.formatInteger(product.price, 0, 'COMMA') + '원'}">50,000원</span>
                                            <span class="price-sale" 
                                                  th:text="${#numbers.formatInteger(product.discountPrice, 0, 'COMMA') + '원'}">45,000원</span>
                                        </div>
                                        <div th:unless="${product.discountRate != null and product.discountRate > 0}">
                                            <span class="price-sale" 
                                                  th:text="${#numbers.formatInteger(product.price, 0, 'COMMA') + '원'}">50,000원</span>
                                        </div>
                                    </div>
                                    
                                    <div class="prime-badge" th:if="${product.price >= 30000}">
                                        <i class="fas fa-truck"></i> 무료배송
                                    </div>
                                </div>
                            </a>
                        </div>
                    </div>
                    
                    <button class="carousel-btn next" onclick="moveCarousel('new', 1)" aria-label="다음">
                        <i class="fas fa-chevron-right"></i>
                    </button>
                </div>
                
                <div th:if="${newProducts.isEmpty()}" style="text-align: center; padding: 120px 20px; color: #999;">
                    <i class="fas fa-box-open"></i>
                    <p>등록된 상품이 없습니다</p>
                </div>
            </div>
        </section>
    </main>
    
    <th:block layout:fragment="script">
        <script th:src="@{/js/main.js}"></script>
    </th:block>
</body>
</html>
